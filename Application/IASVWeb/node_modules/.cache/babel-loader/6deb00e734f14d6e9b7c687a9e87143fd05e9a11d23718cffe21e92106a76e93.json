{"ast":null,"code":"import React,{useState,useEffect,useRef,useMemo}from'react';import{fetchMatchesForClub}from'./../api';// Assurez-vous que le chemin d'importation est correct\nimport'./css/MatchsContent.css';// Importation du CSS\nimport config from'../../config';// Import du fichier config.js\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function MatchsContent(){const[matches,setMatches]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const matchRefs=useRef([]);const scrollContainerRef=useRef(null);// Ajouter une ref pour le conteneur\nconst[selectedClub,setSelectedClub]=useState(config.getSelectedClub());// Initialiser avec le club sélectionné\nconst[selectedCompetition,setSelectedCompetition]=useState(config.getSelectedCompetition());// Initialiser avec la compétition sélectionnée\nuseEffect(()=>{// Fonction pour charger les matchs\nconst loadMatches=async()=>{setLoading(true);try{if(selectedClub&&selectedClub.cl_no){// Vérifier si le club est bien défini\nconst data=await fetchMatchesForClub(selectedClub.cl_no);setMatches(data);}}catch(error){setError('Erreur lors de la récupération des matchs.');}finally{setLoading(false);}};// Charger les matchs au démarrage et lorsque le club change\nif(selectedClub&&selectedClub.cl_no){loadMatches();}// Écouter les changements de club et de compétition\nconst handleClubChange=club=>{setSelectedClub(club);setMatches([]);// Réinitialiser les matchs lors du changement de club\n};const handleCompetitionChange=competition=>{setSelectedCompetition(competition);};// Ajouter les gestionnaires d'événements\nconfig.onClubChange(handleClubChange);config.onCompetitionChange(handleCompetitionChange);// Nettoyer les gestionnaires d'événements lors du démontage du composant\nreturn()=>{config.onClubChange(()=>{});config.onCompetitionChange(()=>{});};},[selectedClub]);const filteredMatches=useMemo(()=>{return matches.filter(match=>match.homeTeam===selectedClub.name&&match.homeCompetitionName===selectedCompetition||match.awayTeam===selectedClub.name&&match.awayCompetitionName===selectedCompetition);},[matches,selectedClub.name,selectedCompetition]);useEffect(()=>{if(filteredMatches.length>0){const today=new Date();console.log('Today\\'s date:',today);const lastMatchIndex=filteredMatches.reduce((lastIndex,match,index)=>{const matchDate=new Date(match.date);console.log(\"Match \".concat(index,\": \"),matchDate);return matchDate<today&&(lastIndex===-1||matchDate>new Date(filteredMatches[lastIndex].date))?index:lastIndex;},-1);console.log('Last match index:',lastMatchIndex);if(lastMatchIndex>=0&&matchRefs.current[lastMatchIndex]){scrollContainerRef.current.scrollTo({top:matchRefs.current[lastMatchIndex].offsetTop-93,// Ajustez la valeur en fonction des marges ou paddings\nbehavior:'smooth'});}}},[filteredMatches]);if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Chargement des matchs...\"});}if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"error\",children:[\"Erreur : \",error]});}return/*#__PURE__*/_jsx(\"div\",{className:\"tab-content-match\",children:filteredMatches.length===0?/*#__PURE__*/_jsxs(\"p\",{className:\"error\",children:[\"Aucun match trouv\\xE9 pour \",selectedClub.name,\".\"]}):/*#__PURE__*/_jsxs(\"div\",{className:\"scroll-container\",ref:scrollContainerRef,children:[\" \",filteredMatches.map((match,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"match-item\",ref:el=>matchRefs.current[index]=el,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"match-date\",children:[new Date(match.date).toLocaleDateString(),\" - \",match.time,\" - \",match.competitionName]}),/*#__PURE__*/_jsxs(\"div\",{className:\"match-content\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"match-details-team\",children:[/*#__PURE__*/_jsx(\"img\",{src:match.homeLogo,alt:\"\".concat(match.homeTeam,\" logo\"),className:\"team-logo\"}),match.homeTeam]}),/*#__PURE__*/_jsx(\"div\",{className:\"match-score\",children:match.home_score}),/*#__PURE__*/_jsxs(\"div\",{className:\"match-details-team\",children:[/*#__PURE__*/_jsx(\"img\",{src:match.awayLogo,alt:\"\".concat(match.awayTeam,\" logo\"),className:\"team-logo\"}),match.awayTeam]}),/*#__PURE__*/_jsx(\"div\",{className:\"match-score\",children:match.away_score})]})]},match.id))]})});}export default MatchsContent;","map":{"version":3,"names":["React","useState","useEffect","useRef","useMemo","fetchMatchesForClub","config","jsx","_jsx","jsxs","_jsxs","MatchsContent","matches","setMatches","loading","setLoading","error","setError","matchRefs","scrollContainerRef","selectedClub","setSelectedClub","getSelectedClub","selectedCompetition","setSelectedCompetition","getSelectedCompetition","loadMatches","cl_no","data","handleClubChange","club","handleCompetitionChange","competition","onClubChange","onCompetitionChange","filteredMatches","filter","match","homeTeam","name","homeCompetitionName","awayTeam","awayCompetitionName","length","today","Date","console","log","lastMatchIndex","reduce","lastIndex","index","matchDate","date","concat","current","scrollTo","top","offsetTop","behavior","className","children","ref","map","el","toLocaleDateString","time","competitionName","src","homeLogo","alt","home_score","awayLogo","away_score","id"],"sources":["C:/perso/IA Sport Vision/Application/IASV/src/components/Resultat/MatchsContent.js"],"sourcesContent":["import React, { useState, useEffect, useRef, useMemo } from 'react';\r\nimport { fetchMatchesForClub } from './../api'; // Assurez-vous que le chemin d'importation est correct\r\nimport './css/MatchsContent.css'; // Importation du CSS\r\nimport config from '../../config';  // Import du fichier config.js\r\n\r\nfunction MatchsContent() {\r\n  const [matches, setMatches] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const matchRefs = useRef([]);\r\n  const scrollContainerRef = useRef(null); // Ajouter une ref pour le conteneur\r\n  const [selectedClub, setSelectedClub] = useState(config.getSelectedClub());  // Initialiser avec le club sélectionné\r\n  const [selectedCompetition, setSelectedCompetition] = useState(config.getSelectedCompetition());  // Initialiser avec la compétition sélectionnée\r\n\r\n  useEffect(() => {\r\n    // Fonction pour charger les matchs\r\n    const loadMatches = async () => {\r\n      setLoading(true);\r\n      try {\r\n        if (selectedClub && selectedClub.cl_no) {  // Vérifier si le club est bien défini\r\n          const data = await fetchMatchesForClub(selectedClub.cl_no);\r\n          setMatches(data);\r\n        }\r\n      } catch (error) {\r\n        setError('Erreur lors de la récupération des matchs.');\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    // Charger les matchs au démarrage et lorsque le club change\r\n    if (selectedClub && selectedClub.cl_no) {\r\n      loadMatches();\r\n    }\r\n\r\n    // Écouter les changements de club et de compétition\r\n    const handleClubChange = (club) => {\r\n      setSelectedClub(club);\r\n      setMatches([]);  // Réinitialiser les matchs lors du changement de club\r\n    };\r\n\r\n    const handleCompetitionChange = (competition) => {\r\n      setSelectedCompetition(competition);\r\n    };\r\n\r\n    // Ajouter les gestionnaires d'événements\r\n    config.onClubChange(handleClubChange);\r\n    config.onCompetitionChange(handleCompetitionChange);\r\n\r\n    // Nettoyer les gestionnaires d'événements lors du démontage du composant\r\n    return () => {\r\n      config.onClubChange(() => {});\r\n      config.onCompetitionChange(() => {});\r\n    };\r\n  }, [selectedClub]);\r\n\r\n  const filteredMatches = useMemo(() => {\r\n    return matches.filter(\r\n      match =>\r\n        (match.homeTeam === selectedClub.name && match.homeCompetitionName === selectedCompetition) ||\r\n        (match.awayTeam === selectedClub.name && match.awayCompetitionName === selectedCompetition)\r\n    );\r\n  }, [matches, selectedClub.name, selectedCompetition]);\r\n\r\n  useEffect(() => {\r\n    if (filteredMatches.length > 0) {\r\n      const today = new Date();\r\n      console.log('Today\\'s date:', today);\r\n      const lastMatchIndex = filteredMatches.reduce((lastIndex, match, index) => {\r\n        const matchDate = new Date(match.date);\r\n        console.log(`Match ${index}: `, matchDate);\r\n        return matchDate < today && (lastIndex === -1 || matchDate > new Date(filteredMatches[lastIndex].date))\r\n          ? index\r\n          : lastIndex;\r\n      }, -1);\r\n  \r\n      console.log('Last match index:', lastMatchIndex);\r\n  \r\n      if (lastMatchIndex >= 0 && matchRefs.current[lastMatchIndex]) {\r\n        scrollContainerRef.current.scrollTo({\r\n          top: matchRefs.current[lastMatchIndex].offsetTop - 93, // Ajustez la valeur en fonction des marges ou paddings\r\n          behavior: 'smooth',\r\n        });\r\n        \r\n      }\r\n    }\r\n  }, [filteredMatches]);\r\n  \r\n\r\n  if (loading) {\r\n    return <div className=\"loading\">Chargement des matchs...</div>;\r\n  }\r\n\r\n  if (error) {\r\n    return <div className=\"error\">Erreur : {error}</div>;\r\n  }\r\n\r\n  return (\r\n    <div className=\"tab-content-match\">\r\n      {filteredMatches.length === 0 ? (\r\n        <p className=\"error\">Aucun match trouvé pour {selectedClub.name}.</p>\r\n      ) : (\r\n        <div className=\"scroll-container\" ref={scrollContainerRef}> {/* Ajout de la classe scroll-container */}\r\n          {filteredMatches.map((match, index) => (\r\n            <div\r\n              key={match.id}\r\n              className=\"match-item\"\r\n              ref={el => matchRefs.current[index] = el}\r\n            >\r\n              <div className=\"match-date\">\r\n                {new Date(match.date).toLocaleDateString()} - {match.time} - {match.competitionName}\r\n              </div>\r\n              <div className=\"match-content\">\r\n                <div className=\"match-details-team\">\r\n                  <img src={match.homeLogo} alt={`${match.homeTeam} logo`} className=\"team-logo\" />\r\n                  {match.homeTeam}\r\n                </div>\r\n                <div className=\"match-score\">\r\n                  {match.home_score}\r\n                </div>\r\n                <div className=\"match-details-team\">\r\n                  <img src={match.awayLogo} alt={`${match.awayTeam} logo`} className=\"team-logo\" />\r\n                  {match.awayTeam}\r\n                </div>\r\n                <div className=\"match-score\">\r\n                  {match.away_score}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default MatchsContent;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}